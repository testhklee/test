DROP SEQUENCE PROJECT_BOARD_SEQ;
DROP TABLE PROJECT_BOARD PURGE; 

CREATE SEQUENCE PROJECT_BOARD_SEQ;
/* 프로젝트 게시물 */
CREATE TABLE PROJECT_BOARD (
	PROJECT_BOARD_NO NUMBER NOT NULL, /* 게시물 번호 */
	SOUP_NO NUMBER NOT NULL, /* 프로젝트 번호 */
	MEMBER_NO NUMBER NOT NULL, /* 회원 번호 */
	PROJECT_BOARD_TITLE VARCHAR2(100) NOT NULL, /* 게시물 제목 */
	PROJECT_BOARD_CONTENT VARCHAR2(1000) NOT NULL, /* 게시물 내용 */
	PROJECT_BOARD_DATE DATE NOT NULL, /* 작성일 */
	PROJECT_BOARD_FIXED VARCHAR2(2) NOT NULL, /* 게시물 고정 Y/N */
	PROJECT_BOARD_GUBUN VARCHAR2(20) NOT NULL, /* 게시물 구분 (공지:NOTICE, 참고:RESOURCE, 할일:TODO, 진행중:PROGRESS, 완료:DONE)*/
	PROJECT_BOARD_ORDER NUMBER NOT NULL, /* 게시물 순번 */
	PROJECT_BOARD_SCOPE VARCHAR2(2) NOT NULL, /* 수정 / 삭제 권한 범위 */
	PROJECT_BOARD_START_DATE DATE, /* 일정 시작 날짜 */
	PROJECT_BOARD_END_DATE DATE, /* 일정 종료 날짜 */
	PROJECT_BOARD_FILE_URL VARCHAR2(300), /* 첨부 파일 경로 */
	PROJECT_BOARD_FILE_NAME VARCHAR2(200), /* 실제 파일 명 */
	PROJECT_BOARD_CHECKLIST_NAME VARCHAR2(50), /* 체크리스트 명 */
	PROJECT_BOARD_ISDEL VARCHAR2(2) /* 삭제여부 */
);

ALTER TABLE PROJECT_BOARD
	ADD
		CONSTRAINT PK_PROJECT_BOARD
		PRIMARY KEY (
			PROJECT_BOARD_NO
		);

ALTER TABLE PROJECT_BOARD
	ADD
		CONSTRAINT UK_PROJECT_BOARD
		UNIQUE (
			PROJECT_BOARD_FILE_URL
		);

ALTER TABLE PROJECT_BOARD
	ADD
		CONSTRAINT FK_SOUP_TO_PROJECT_BOARD
		FOREIGN KEY (
			SOUP_NO
		)
		REFERENCES SOUP (
			SOUP_NO
		);

ALTER TABLE PROJECT_BOARD
	ADD
		CONSTRAINT FK_MEMBER_TO_PROJECT_BOARD
		FOREIGN KEY (
			MEMBER_NO
		)
		REFERENCES MEMBER (
			MEMBER_NO
		);

DELETE FROM PROJECT_BOARD		
		
--게시물 생성
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 32, '공지1', '힝', SYSDATE, 'NOTICE', NULL, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 31, '공지2', '힝2', SYSDATE, 'NOTICE', NULL, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 30, '공지3', '힝3', SYSDATE, 'NOTICE', NULL, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 32, '참고1', '참고TEST1', SYSDATE, 'RESOURCE', 1, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 31, '참고2', '참고TEST2', SYSDATE, 'RESOURCE', 2, 'P', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 30, '참고3', '참고TEST3', SYSDATE, 'RESOURCE', 3, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 32, '1번글', '1번글내용', SYSDATE, 'TODO', 1, 'A', 'Y', NULL, NULL, NULL, '체크리스트 테스트', 'N');
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 31, '2번글', '2번글내용', SYSDATE, 'TODO', 2, 'P', 'Y', NULL, NULL, NULL, NULL, 'N');
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 30, '3번글', '3번글내용', SYSDATE, 'TODO', 3, 'A', 'Y', NULL, NULL, NULL, NULL, 'Y');
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 32, '4번글', '4번글내용', SYSDATE, 'PROGRESS', 1, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 31, '5번글', '5번글내용', SYSDATE, 'PROGRESS', 2, 'P', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 30, '6번글', '6번글내용', SYSDATE, 'PROGRESS', 3, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 32, '7번글', '7번글내용', SYSDATE, 'DONE', 1, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 31, '8번글', '8번글내용', SYSDATE, 'DONE', 2, 'P', 'Y', NULL, NULL, NULL, NULL, NULL);
INSERT INTO PROJECT_BOARD VALUES(PROJECT_BOARD_SEQ.NEXTVAL, 21, 30, '9번글', '9번글내용', SYSDATE, 'DONE', 3, 'A', 'Y', NULL, NULL, NULL, NULL, NULL);

INSERT INTO PROJECT_BOARD
VALUES(PROJECT_BOARD_SEQ.NEXTVAL,
	    #{soupNo}, 
	    #{memberNo}, 
	    #{boardTitle}, 
	    #{boardContent}, 
	    SYSDATE, 
	    #{boardGubun}, 
	    (SELECT COUNT(*) FROM )		

		
--게시물 순서 업데이트

		
UPDATE PROJECT_BOARD SET PROJECT_BOARD_ORDER = #{projectBoardOrder} WHERE PROJECT_BOARD_NO = #{projectBoardNo}

